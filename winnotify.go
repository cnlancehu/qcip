//go:build windows

package main

import (
	"os"

	"gopkg.in/toast.v1"
)

var (
	// static/success.svg
	successicon = []byte{0x3C, 0x3F, 0x78, 0x6D, 0x6C, 0x20, 0x76, 0x65, 0x72, 0x73, 0x69, 0x6F, 0x6E, 0x3D, 0x22, 0x31,
		0x2E, 0x30, 0x22, 0x20, 0x73, 0x74, 0x61, 0x6E, 0x64, 0x61, 0x6C, 0x6F, 0x6E, 0x65, 0x3D, 0x22,
		0x6E, 0x6F, 0x22, 0x3F, 0x3E, 0x0A, 0x3C, 0x73, 0x76, 0x67, 0x20, 0x78, 0x6D, 0x6C, 0x6E, 0x73,
		0x3D, 0x22, 0x68, 0x74, 0x74, 0x70, 0x3A, 0x2F, 0x2F, 0x77, 0x77, 0x77, 0x2E, 0x77, 0x33, 0x2E,
		0x6F, 0x72, 0x67, 0x2F, 0x32, 0x30, 0x30, 0x30, 0x2F, 0x73, 0x76, 0x67, 0x22, 0x20, 0x78, 0x6D,
		0x6C, 0x6E, 0x73, 0x3A, 0x78, 0x6C, 0x69, 0x6E, 0x6B, 0x3D, 0x22, 0x68, 0x74, 0x74, 0x70, 0x3A,
		0x2F, 0x2F, 0x77, 0x77, 0x77, 0x2E, 0x77, 0x33, 0x2E, 0x6F, 0x72, 0x67, 0x2F, 0x31, 0x39, 0x39,
		0x39, 0x2F, 0x78, 0x6C, 0x69, 0x6E, 0x6B, 0x22, 0x20, 0x76, 0x65, 0x72, 0x73, 0x69, 0x6F, 0x6E,
		0x3D, 0x22, 0x31, 0x2E, 0x31, 0x22, 0x20, 0x76, 0x69, 0x65, 0x77, 0x42, 0x6F, 0x78, 0x3D, 0x22,
		0x2D, 0x31, 0x30, 0x20, 0x30, 0x20, 0x32, 0x30, 0x35, 0x38, 0x20, 0x32, 0x30, 0x34, 0x38, 0x22,
		0x3E, 0x0A, 0x20, 0x20, 0x20, 0x3C, 0x70, 0x61, 0x74, 0x68, 0x20, 0x66, 0x69, 0x6C, 0x6C, 0x3D,
		0x22, 0x63, 0x75, 0x72, 0x72, 0x65, 0x6E, 0x74, 0x43, 0x6F, 0x6C, 0x6F, 0x72, 0x22, 0x0A, 0x64,
		0x3D, 0x22, 0x4D, 0x31, 0x37, 0x31, 0x20, 0x31, 0x31, 0x30, 0x39, 0x71, 0x30, 0x20, 0x2D, 0x33,
		0x35, 0x20, 0x32, 0x35, 0x20, 0x2D, 0x36, 0x30, 0x74, 0x36, 0x30, 0x20, 0x2D, 0x32, 0x35, 0x74,
		0x36, 0x30, 0x20, 0x32, 0x35, 0x6C, 0x34, 0x35, 0x32, 0x20, 0x34, 0x35, 0x32, 0x6C, 0x39, 0x36,
		0x34, 0x20, 0x2D, 0x39, 0x36, 0x34, 0x71, 0x32, 0x35, 0x20, 0x2D, 0x32, 0x35, 0x20, 0x36, 0x30,
		0x20, 0x2D, 0x32, 0x35, 0x71, 0x31, 0x38, 0x20, 0x30, 0x20, 0x33, 0x33, 0x2E, 0x35, 0x20, 0x36,
		0x2E, 0x35, 0x74, 0x32, 0x37, 0x20, 0x31, 0x38, 0x74, 0x31, 0x38, 0x2E, 0x35, 0x20, 0x32, 0x37,
		0x74, 0x37, 0x20, 0x33, 0x33, 0x2E, 0x35, 0x71, 0x30, 0x20, 0x33, 0x35, 0x20, 0x2D, 0x32, 0x36,
		0x20, 0x36, 0x31, 0x6C, 0x2D, 0x31, 0x30, 0x32, 0x34, 0x20, 0x31, 0x30, 0x32, 0x34, 0x71, 0x2D,
		0x32, 0x35, 0x20, 0x32, 0x35, 0x20, 0x2D, 0x36, 0x30, 0x20, 0x32, 0x35, 0x74, 0x2D, 0x36, 0x30,
		0x20, 0x2D, 0x32, 0x35, 0x6C, 0x2D, 0x35, 0x31, 0x32, 0x20, 0x2D, 0x35, 0x31, 0x32, 0x71, 0x2D,
		0x32, 0x35, 0x20, 0x2D, 0x32, 0x35, 0x20, 0x2D, 0x32, 0x35, 0x20, 0x2D, 0x36, 0x31, 0x7A, 0x22,
		0x20, 0x2F, 0x3E, 0x0A, 0x3C, 0x2F, 0x73, 0x76, 0x67, 0x3E}

	// static/failed.svg
	failedicon = []byte{0x3C, 0x3F, 0x78, 0x6D, 0x6C, 0x20, 0x76, 0x65, 0x72, 0x73, 0x69, 0x6F, 0x6E, 0x3D, 0x22, 0x31,
		0x2E, 0x30, 0x22, 0x20, 0x73, 0x74, 0x61, 0x6E, 0x64, 0x61, 0x6C, 0x6F, 0x6E, 0x65, 0x3D, 0x22,
		0x6E, 0x6F, 0x22, 0x3F, 0x3E, 0x0A, 0x3C, 0x73, 0x76, 0x67, 0x20, 0x78, 0x6D, 0x6C, 0x6E, 0x73,
		0x3D, 0x22, 0x68, 0x74, 0x74, 0x70, 0x3A, 0x2F, 0x2F, 0x77, 0x77, 0x77, 0x2E, 0x77, 0x33, 0x2E,
		0x6F, 0x72, 0x67, 0x2F, 0x32, 0x30, 0x30, 0x30, 0x2F, 0x73, 0x76, 0x67, 0x22, 0x20, 0x78, 0x6D,
		0x6C, 0x6E, 0x73, 0x3A, 0x78, 0x6C, 0x69, 0x6E, 0x6B, 0x3D, 0x22, 0x68, 0x74, 0x74, 0x70, 0x3A,
		0x2F, 0x2F, 0x77, 0x77, 0x77, 0x2E, 0x77, 0x33, 0x2E, 0x6F, 0x72, 0x67, 0x2F, 0x31, 0x39, 0x39,
		0x39, 0x2F, 0x78, 0x6C, 0x69, 0x6E, 0x6B, 0x22, 0x20, 0x76, 0x65, 0x72, 0x73, 0x69, 0x6F, 0x6E,
		0x3D, 0x22, 0x31, 0x2E, 0x31, 0x22, 0x20, 0x76, 0x69, 0x65, 0x77, 0x42, 0x6F, 0x78, 0x3D, 0x22,
		0x2D, 0x31, 0x30, 0x20, 0x30, 0x20, 0x32, 0x30, 0x35, 0x38, 0x20, 0x32, 0x30, 0x34, 0x38, 0x22,
		0x3E, 0x0A, 0x20, 0x20, 0x20, 0x3C, 0x70, 0x61, 0x74, 0x68, 0x20, 0x66, 0x69, 0x6C, 0x6C, 0x3D,
		0x22, 0x63, 0x75, 0x72, 0x72, 0x65, 0x6E, 0x74, 0x43, 0x6F, 0x6C, 0x6F, 0x72, 0x22, 0x0A, 0x64,
		0x3D, 0x22, 0x4D, 0x32, 0x30, 0x37, 0x20, 0x31, 0x39, 0x32, 0x32, 0x71, 0x2D, 0x33, 0x39, 0x20,
		0x30, 0x20, 0x2D, 0x37, 0x33, 0x2E, 0x35, 0x20, 0x2D, 0x31, 0x35, 0x74, 0x2D, 0x36, 0x31, 0x20,
		0x2D, 0x34, 0x31, 0x74, 0x2D, 0x34, 0x32, 0x20, 0x2D, 0x36, 0x30, 0x2E, 0x35, 0x74, 0x2D, 0x31,
		0x35, 0x2E, 0x35, 0x20, 0x2D, 0x37, 0x33, 0x2E, 0x35, 0x71, 0x30, 0x20, 0x2D, 0x34, 0x36, 0x20,
		0x32, 0x30, 0x20, 0x2D, 0x38, 0x38, 0x6C, 0x37, 0x35, 0x33, 0x20, 0x2D, 0x31, 0x35, 0x30, 0x36,
		0x71, 0x32, 0x34, 0x20, 0x2D, 0x34, 0x38, 0x20, 0x37, 0x31, 0x20, 0x2D, 0x37, 0x37, 0x74, 0x31,
		0x30, 0x31, 0x20, 0x2D, 0x32, 0x39, 0x74, 0x31, 0x30, 0x31, 0x20, 0x32, 0x39, 0x74, 0x37, 0x31,
		0x20, 0x37, 0x37, 0x6C, 0x37, 0x35, 0x33, 0x20, 0x31, 0x35, 0x30, 0x36, 0x71, 0x32, 0x30, 0x20,
		0x34, 0x32, 0x20, 0x32, 0x30, 0x20, 0x38, 0x38, 0x71, 0x30, 0x20, 0x33, 0x39, 0x20, 0x2D, 0x31,
		0x35, 0x2E, 0x35, 0x20, 0x37, 0x33, 0x2E, 0x35, 0x74, 0x2D, 0x34, 0x31, 0x2E, 0x35, 0x20, 0x36,
		0x30, 0x2E, 0x35, 0x74, 0x2D, 0x36, 0x31, 0x20, 0x34, 0x31, 0x74, 0x2D, 0x37, 0x34, 0x20, 0x31,
		0x35, 0x68, 0x2D, 0x31, 0x35, 0x30, 0x36, 0x7A, 0x4D, 0x31, 0x37, 0x31, 0x33, 0x20, 0x31, 0x37,
		0x39, 0x34, 0x71, 0x32, 0x34, 0x20, 0x30, 0x20, 0x34, 0x34, 0x20, 0x2D, 0x31, 0x38, 0x74, 0x32,
		0x30, 0x20, 0x2D, 0x34, 0x33, 0x71, 0x30, 0x20, 0x2D, 0x31, 0x38, 0x20, 0x2D, 0x37, 0x20, 0x2D,
		0x33, 0x32, 0x6C, 0x2D, 0x37, 0x35, 0x33, 0x20, 0x2D, 0x31, 0x35, 0x30, 0x36, 0x0A, 0x71, 0x2D,
		0x38, 0x20, 0x2D, 0x31, 0x37, 0x20, 0x2D, 0x32, 0x33, 0x2E, 0x35, 0x20, 0x2D, 0x32, 0x36, 0x74,
		0x2D, 0x33, 0x33, 0x2E, 0x35, 0x20, 0x2D, 0x39, 0x74, 0x2D, 0x33, 0x33, 0x2E, 0x35, 0x20, 0x39,
		0x2E, 0x35, 0x74, 0x2D, 0x32, 0x33, 0x2E, 0x35, 0x20, 0x32, 0x35, 0x2E, 0x35, 0x6C, 0x2D, 0x37,
		0x35, 0x33, 0x20, 0x31, 0x35, 0x30, 0x36, 0x71, 0x2D, 0x37, 0x20, 0x31, 0x34, 0x20, 0x2D, 0x37,
		0x20, 0x33, 0x31, 0x71, 0x30, 0x20, 0x32, 0x36, 0x20, 0x31, 0x39, 0x2E, 0x35, 0x20, 0x34, 0x34,
		0x74, 0x34, 0x34, 0x2E, 0x35, 0x20, 0x31, 0x38, 0x68, 0x31, 0x35, 0x30, 0x36, 0x7A, 0x4D, 0x38,
		0x39, 0x36, 0x20, 0x31, 0x32, 0x31, 0x36, 0x76, 0x2D, 0x35, 0x31, 0x32, 0x71, 0x30, 0x20, 0x2D,
		0x32, 0x36, 0x20, 0x31, 0x39, 0x20, 0x2D, 0x34, 0x35, 0x74, 0x34, 0x35, 0x20, 0x2D, 0x31, 0x39,
		0x74, 0x34, 0x35, 0x20, 0x31, 0x39, 0x74, 0x31, 0x39, 0x20, 0x34, 0x35, 0x76, 0x35, 0x31, 0x32,
		0x71, 0x30, 0x20, 0x32, 0x36, 0x20, 0x2D, 0x31, 0x39, 0x20, 0x34, 0x35, 0x74, 0x2D, 0x34, 0x35,
		0x20, 0x31, 0x39, 0x74, 0x2D, 0x34, 0x35, 0x20, 0x2D, 0x31, 0x39, 0x74, 0x2D, 0x31, 0x39, 0x20,
		0x2D, 0x34, 0x35, 0x7A, 0x4D, 0x38, 0x36, 0x34, 0x20, 0x31, 0x34, 0x37, 0x32, 0x71, 0x30, 0x20,
		0x2D, 0x34, 0x30, 0x20, 0x32, 0x38, 0x20, 0x2D, 0x36, 0x38, 0x74, 0x36, 0x38, 0x20, 0x2D, 0x32,
		0x38, 0x74, 0x36, 0x38, 0x20, 0x32, 0x38, 0x74, 0x32, 0x38, 0x20, 0x36, 0x38, 0x74, 0x2D, 0x32,
		0x38, 0x20, 0x36, 0x38, 0x74, 0x2D, 0x36, 0x38, 0x20, 0x32, 0x38, 0x74, 0x2D, 0x36, 0x38, 0x20,
		0x2D, 0x32, 0x38, 0x74, 0x2D, 0x32, 0x38, 0x20, 0x2D, 0x36, 0x38, 0x7A, 0x0A, 0x22, 0x20, 0x2F,
		0x3E, 0x0A, 0x3C, 0x2F, 0x73, 0x76, 0x67, 0x3E}
	err error
)

func init() {
	// 系统为 windows 时，启用 winnotify 并显示对应的帮助信息

	notifyHelpMsg = "\n  -n, --winnotify	Send notifacation cards, only available on Windows"
	notify = func(title string, message string, succeed bool) {
		var tmpFile *os.File
		tmpFile, err = os.CreateTemp("", "qcip-*.svg")
		if succeed {
			tmpFile.Write(successicon)
		} else {
			tmpFile.Write(failedicon)
		}
		err = tmpFile.Close()
		iconpath := tmpFile.Name()
		var notification toast.Notification
		if err == nil {
			notification = toast.Notification{
				AppID:   "QCIP",
				Title:   title,
				Message: message,
				Icon:    iconpath,
			}
		} else {
			notification = toast.Notification{
				AppID:   "QCIP",
				Title:   title,
				Message: message,
			}
		}
		err = notification.Push()
		if err != nil {
			errhandle("Error while sending notification: " + err.Error())
		}
	}
}
